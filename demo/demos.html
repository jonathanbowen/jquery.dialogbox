<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Demos</title>
    <link rel="stylesheet" type="text/css" href="../jquery.dialogbox.0.1.css" />
    <script type="text/javascript">//<![CDATA[    	    document.write('<style type="text/css"> .js-hide { display: none; } </style>');    	//]]>    </script>
</head>
<body>
    <p>
        Doctor Cuddles pet shop sells <a href="#info-dachshunds">dachshunds</a>, <a href="#info-kittens">kittens</a> and <a href="#info-bunnies">bunny rabbits</a>.</p>
    </p>

    <div class="js-hide">   
        <p id="info-dachshunds">
            Dachshunds are small, cuddly little dogs with very short legs (more information on <a href="http://en.wikipedia.org/wiki/Dachshund">wikipedia</a>).
        </p>
        <p id="info-kittens">
            Kittens are lickle baby cats (more information on <a href="http://en.wikipedia.org/wiki/Kitten">wikipedia</a>).
        </p>
        <p id="info-bunnies">
            Rabbits are small mammals in the family Leporidae (more information on <a href="http://en.wikipedia.org/wiki/Rabbit">wikipedia</a>).
        </p>
    </div> 
    
    <h2>2. Product table</h2>
    
    <div id="product-holder">
        <table id="products">
            <tr>
                <td class="product-name">Product One</td>
                <td>
                    <form action="delete.php" method="post">
                        <input type="hidden" name="id" value="1" />
                        <input type="submit" value="Delete" class="product-delete" />
                    </form>
                </td>
            </tr>
            <tr>
                <td class="product-name">Product Two</td>
                <td>
                    <form action="delete.php" method="post">
                        <input type="hidden" name="id" value="2" />
                        <input type="submit" value="Delete" class="product-delete" />
                    </form>
                </td>
            </tr>
        </table>
    </div>
    
<script type="text/javascript" src="jquery-1.4.1.min.js"></script>
<script type="text/javascript" src="jquery-ui-1.7.2.custom.min.js"></script>
<script type="text/javascript" src="../jquery.dialogbox.0.1.js"></script>
<script type="text/javascript">	//<![CDATA[(function($) {
    
$(function() {
    
    $.fn.dialogbox.preload();
    
    // hide all information paragraphs    
    $('*[id^=info-]').hide();
    $('a[href^=#info-]').dialogbox(function(e) {
        // get id of target paragraph and use its content as the dialog message
        var targetId = $(e.target).attr('href').split('#')[1];
        return $('#' + targetId).html();
    });
    
    function productDelete() {
        
        // trigger confirm dialog on each submit button in table
        $('input.product-delete').dialogbox(function(e) {
        
            // find the name of the product to be deleted,
            // so it can be shown in the confirmation message
            var $input = $(e.target),
                $row = $input.parents('tr'),
                productName = $row.children('td.product-name').text();
            
            return {
                message: 'Really delete ' + productName + '?',
                title: 'Delete product',
                type: 'confirm',
                confirm: function(box) {
                    
                    // add loading indicator
                    // (this also prevents the box from automatically closing)
                    box.addLoadbar();
                    
                    // submit form through ajax request
                    var $form = $input.parents('form');
                    $.post('delete.php', $form.serialize(), function(response) {
                        
                        // close dialog and update product table with response
                        box.close();
                        $('#product-holder').html(response);
                        
                        // attach the dialog to submit buttons in the updated table
                        productDelete();
                    });
                }
            }
        });
    }
    productDelete();
    
});
    
})(jQuery);			//]]></script>
</body>
</html>